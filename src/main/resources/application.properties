# Application Configuration
spring.application.name=esprithub-server
server.port=${PORT:8090}

# Database Configuration

spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5433/esprithub}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:esprithub_user}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:esprithub_password}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA Configuration
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=true

# JWT Configuration - Use environment variables for production!
app.jwt.secret=${JWT_SECRET:TXlTZWNyZXRLZXkxMjNNeVNlY3JldEtleTEyM015U2VjcmV0S2V5MTIzTXlTZWNyZXRLZXkxMjM=}
app.jwt.expiration=${JWT_EXPIRATION:86400000}
app.jwt.refresh-expiration=${JWT_REFRESH_EXPIRATION:604800000}
spring.servlet.multipart.max-file-size=700MB
spring.servlet.multipart.max-request-size=700MB
# GitHub OAuth Configuration
spring.security.oauth2.client.registration.github.client-id=${GITHUB_CLIENT_ID:your-github-client-id}
spring.security.oauth2.client.registration.github.client-secret=${GITHUB_CLIENT_SECRET:your-github-client-secret}
spring.security.oauth2.client.registration.github.scope=user:email,repo

# GitHub OAuth Redirect URI - Must match exactly what's configured in your GitHub OAuth App
# For Heroku deployment: https://esprithub-a9b0532d96dd.herokuapp.com/auth/github/callback
github.oauth.redirect-uri=${GITHUB_OAUTH_REDIRECT_URI:https://esprithub-a9b0532d96dd.herokuapp.com/auth/github/callback}

# GitHub Organization Configuration
github.organization.name=${GITHUB_ORG_NAME:esprithub}

# CORS Configuration
app.cors.allowed-origins=http://localhost:4200,http://127.0.0.1:4200,https://esprithub-a9b0532d96dd.herokuapp.com,https://esprithub.herokuapp.com,https://esprithub-frontend.herokuapp.com,postgresql://postgres:gTR5YQ2003*@db.cgivcyorjgfphvytnxnx.supabase.co:5432/postgres
app.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS,PATCH
app.cors.allowed-headers=*
app.cors.allow-credentials=true

# Logging
logging.level.tn.esprithub.server=DEBUG
logging.level.org.springframework.security=DEBUG

# Teams Webhook Configuration
app.teams.webhook.url=${TEAMS_WEBHOOK_URL:}

# GitHub Webhook Configuration
app.webhook.base-url=${WEBHOOK_BASE_URL:http://localhost:8090}
app.webhook.endpoint=/api/github/webhook
app.webhook.secret=${WEBHOOK_SECRET:your-webhook-secret-change-in-production}
app.webhook.events=push,pull_request,issues,create,delete,release,fork,watch
app.webhook.scheduling.subscription-check-interval=30
app.webhook.scheduling.health-check-interval=6
app.webhook.scheduling.enabled=true
app.webhook.retry.max-attempts=3
app.webhook.retry.max-failures=5
app.webhook.retry.retry-delay=15

# Notification Configuration
app.notifications.enabled=true
app.notifications.email.enabled=true
app.notifications.teams.enabled=true
app.notifications.deadline.critical-days=1
app.notifications.deadline.warning-days=3
app.notifications.deadline.info-days=7


# Email Configuration
app.mail.enabled=${APP_MAIL_ENABLED:true}
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=${SPRING_MAIL_USERNAME:}
spring.mail.password=${SPRING_MAIL_PASSWORD:}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.default-encoding=UTF-8

# Configuration de l'IA
# Pour utiliser l'IA, vous devez configurer votre clé API OpenAI :
# 1. Allez sur https://platform.openai.com/api-keys
# 2. Créez une clé API
# 3. Définissez la variable d'environnement : export OPENAI_API_KEY=votre-clé-api
# Ou ajoutez directement la clé ici (non recommandé pour la production)
app.ai.openai.model=gpt-3.5-turbo-16k
app.ai.code-review.enabled=true
app.ai.code-review.auto-analyze=true
app.ai.code-review.notify-on-issues=true
app.ai.code-review.test-mode=false

# Bootstrap configuration
app.bootstrap.admin-email=${BOOTSTRAP_ADMIN_EMAIL:}
app.bootstrap.admin-password=${BOOTSTRAP_ADMIN_PASSWORD:}
app.bootstrap.seed-sample-users=${BOOTSTRAP_SEED_SAMPLE_USERS:false}
# Example (uncomment & override via application-local.properties or env)
# app.bootstrap.sample-users[0].email=test.admin@esprithub.local
# app.bootstrap.sample-users[0].password=ChangeMe123!
# app.bootstrap.sample-users[0].first-name=Test
# app.bootstrap.sample-users[0].last-name=Admin
# app.bootstrap.sample-users[0].role=ADMIN
